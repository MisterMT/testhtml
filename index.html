<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>YouTube Slide Drag</title>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        #container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        iframe {
            position: absolute;
            width: 100%;
            height: 100%;
            border: none;
            transition: transform 0.3s ease;
            will-change: transform;
        }

        #overlay {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 10;
            width: 100%;
            height: 100%;
            background: transparent;
            cursor: grab;
            touch-action: none;
        }
    </style>
</head>

<body>

    <div id="container">
        <iframe id="iframeA" src="https://www.youtube.com/embed/DlSgndRMrLM?autoplay=1&mute=0"
            allow="autoplay; encrypted-media" allowfullscreen>
        </iframe>
        <iframe id="iframeB" src="" allow="autoplay; encrypted-media" allowfullscreen>
        </iframe>
        <div id="overlay"></div>
    </div>

    <script>
        const iframeA = document.getElementById("iframeA");
        const iframeB = document.getElementById("iframeB");
        const overlay = document.getElementById("overlay");

        const videos = [
            "DlSgndRMrLM",
            "p4WlkEEgN8E",
            "o4bsZvV2tKg"
        ];

        let currentIndex = 0;
        let showingA = true;

        let startY = 0;
        let currentY = 0;
        let isDragging = false;

        function getCurrentIframe() {
            return showingA ? iframeA : iframeB;
        }

        function getNextIframe() {
            return showingA ? iframeB : iframeA;
        }

        function clamp(val, min, max) {
            return Math.min(Math.max(val, min), max);
        }

        function prepareNextVideo(direction) {
            const nextIndex = direction === "up"
                ? (currentIndex + 1) % videos.length
                : (currentIndex - 1 + videos.length) % videos.length;

            const nextIframe = getNextIframe();
            const nextId = videos[nextIndex];
            const url = `https://www.youtube.com/embed/${nextId}?autoplay=1&mute=0`;
            nextIframe.src = url;
            nextIframe.style.transform = direction === "up"
                ? "translateY(100%)"
                : "translateY(-100%)";
        }

        overlay.addEventListener("mousedown", e => {
            isDragging = true;
            startY = e.clientY;
        });

        overlay.addEventListener("mousemove", e => {
            if (!isDragging) return;
            currentY = e.clientY;
            const deltaY = currentY - startY;

            const direction = deltaY < 0 ? "up" : "down";
            prepareNextVideo(direction);

            getCurrentIframe().style.transition = "none";
            getNextIframe().style.transition = "none";

            getCurrentIframe().style.transform = `translateY(${deltaY}px)`;
            getNextIframe().style.transform = `translateY(${deltaY + (deltaY < 0 ? window.innerHeight : -window.innerHeight)}px)`;
        });

        overlay.addEventListener("mouseup", () => {
            if (!isDragging) return;
            isDragging = false;

            const deltaY = currentY - startY;
            const threshold = 100;

            const shouldSwitch = Math.abs(deltaY) > threshold;
            const direction = deltaY < 0 ? "up" : "down";

            const current = getCurrentIframe();
            const next = getNextIframe();

            current.style.transition = "transform 0.3s ease";
            next.style.transition = "transform 0.3s ease";

            if (shouldSwitch) {
                current.style.transform = `translateY(${deltaY < 0 ? -window.innerHeight : window.innerHeight}px)`;
                next.style.transform = "translateY(0%)";

                setTimeout(() => {
                    showingA = !showingA;
                    currentIndex = direction === "up"
                        ? (currentIndex + 1) % videos.length
                        : (currentIndex - 1 + videos.length) % videos.length;

                    current.style.transition = "none";
                    current.style.transform = "translateY(0%)";
                    current.src = "";
                    next.
                        console.log("HERE");
                }, 300);
            } else {
                // snap back
                current.style.transform = "translateY(0%)";
                next.style.transform = direction === "up"
                    ? "translateY(100%)"
                    : "translateY(-100%)";
                console.log("THERE");
            }
        });

        // Touch Support
        overlay.addEventListener("touchstart", e => {
            isDragging = true;
            startY = e.touches[0].clientY;
        });

        overlay.addEventListener("touchmove", e => {
            if (!isDragging) return;
            currentY = e.touches[0].clientY;
            const deltaY = currentY - startY;

            const direction = deltaY < 0 ? "up" : "down";
            prepareNextVideo(direction);

            getCurrentIframe().style.transition = "none";
            getNextIframe().style.transition = "none";

            getCurrentIframe().style.transform = `translateY(${deltaY}px)`;
            getNextIframe().style.transform = `translateY(${deltaY + (deltaY < 0 ? window.innerHeight : -window.innerHeight)}px)`;
        });

        overlay.addEventListener("touchend", () => {
            if (!isDragging) return;
            isDragging = false;

            const deltaY = currentY - startY;
            const threshold = 100;

            const shouldSwitch = Math.abs(deltaY) > threshold;
            const direction = deltaY < 0 ? "up" : "down";

            const current = getCurrentIframe();
            const next = getNextIframe();

            current.style.transition = "transform 0.3s ease";
            next.style.transition = "transform 0.3s ease";

            if (shouldSwitch) {
                current.style.transform = `translateY(${deltaY < 0 ? -window.innerHeight : window.innerHeight}px)`;
                next.style.transform = "translateY(0%)";

                setTimeout(() => {
                    showingA = !showingA;
                    currentIndex = direction === "up"
                        ? (currentIndex + 1) % videos.length
                        : (currentIndex - 1 + videos.length) % videos.length;

                    current.style.transition = "none";
                    current.style.transform = "translateY(0%)";
                    current.src = "";
                }, 300);
            } else {
                current.style.transform = "translateY(0%)";
                next.style.transform = direction === "up"
                    ? "translateY(100%)"
                    : "translateY(-100%)";
            }
        });
    </script>

</body>

</html>
